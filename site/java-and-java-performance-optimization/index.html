<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="melvinpetix">
    <link rel="canonical" href="https://petixnginx.tk/library/java-and-java-performance-optimization/">
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Java Memory Management & Java Performance Optimization - melvinpetix library</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Java Memory Management", url: "#_top", children: [
              {title: "Java", url: "#java" },
              {title: "Java Performance Optimization", url: "#java-performance-optimization" },
              {title: "List of Performance Analysis Tools", url: "#list-of-performance-analysis-tools" },
              {title: "Garbage Collection and Heap Offloading", url: "#garbage-collection-and-heap-offloading" },
              {title: "Cambios importantes en la gesti\u00f3n de memoria de Java 8 de Oracle (2014)", url: "#cambios-importantes-en-la-gestion-de-memoria-de-java-8-de-oracle-2014" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script>
      <script src="../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../jvm-parameters-matrix-table/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../jvm-parameters-matrix-table/" class="btn btn-xs btn-link">
        Java Parameters Matrix Table
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../xamarin/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../xamarin/" class="btn btn-xs btn-link">
        Xamarin
      </a>
    </div>
    
  </div>

    

    <h1 id="java-memory-management">Java Memory Management</h1>
<ul>
<li><a href="#java">Java</a></li>
<li><a href="#java-performance-optimization">Java Performance Optimization</a><ul>
<li><a href="#tuning-jenkins-gc">Tuning Jenkins GC</a></li>
<li><a href="#tuning-java-containers">Tuning Java Containers</a></li>
<li><a href="#debugging-java-applications-on-openshift-and-kubernetes">Debugging java applications on OpenShift and Kubernetes</a></li>
</ul>
</li>
<li><a href="#list-of-performance-analysis-tools">List of Performance Analysis Tools</a><ul>
<li><a href="#threadumps-heapdumps-and-gc-analysis-tools">Threadumps, Heapdumps and GC Analysis Tools</a><ul>
<li><a href="#capturing-a-java-thread-dump">Capturing a Java Thread Dump</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#garbage-collection-and-heap-offloading">Garbage Collection and Heap Offloading</a></li>
<li><a href="#cambios-importantes-en-la-gesti√≥n-de-memoria-de-java-8-de-oracle-2014">Cambios importantes en la gesti√≥n de memoria de Java 8 de Oracle (2014)</a></li>
</ul>
<h2 id="java">Java</h2>
<ul>
<li><a href="https://www.reddit.com/r/java">reddit.com/r/java</a></li>
<li><a href="https://medium.com/@javachampions/java-is-still-free-2-0-0-6b9aa8d6d244">medium.com/@javachampions : Java is still free</a></li>
<li><a href="https://blog.joda.org/2018/09/do-not-fall-into-oracles-java-11-trap.html">Oracle Java 11 and OpenJDK</a></li>
<li><a href="https://developers.redhat.com/blog/2018/09/24/the-future-of-java-and-openjdk-updates-without-oracle-support/">developers.redhat.com: The future of Java and OpenJDK updates without Oracle support</a></li>
<li><a href="https://www.redhat.com/en/blog/history-and-future-openjdk">redhat.com: The history and future of OpenJDK</a></li>
<li><a href="https://javarevisited.blogspot.com/2019/10/the-java-developer-roadmap.html">javarevisited.blogspot.com: The 2020 Java Developer RoadMap üåü</a></li>
</ul>
<h2 id="java-performance-optimization">Java Performance Optimization</h2>
<ul>
<li><a href="https://dzone.com/refcardz/java-performance-optimization">DZone refcard: java performance optimization üåü</a> Tools and Techniques for Turbocharged Apps</li>
<li><a href="https://dzone.com/articles/string-concatentions-effect-on-performance">DZone: String Concatenation's Effect on Performance</a> Don‚Äôt use the string concatenation operator to combine more than a few strings unless performance is irrelevant. Use StringBuilder‚Äôs append method instead. </li>
<li><a href="https://dzone.com/articles/performance-improvement-in-java-applications-orm-j">DZone: Performance Improvement in Java Applications: ORM/JPA üåü</a></li>
<li><a href="https://dzone.com/articles/jvm-architecture-explained">DZone: The JVM Architecture Explained üåü</a> An overview of the different components of the JVM, along with a very useful diagram</li>
<li><a href="https://dzone.com/articles/troubleshoot-sudden-cpu-spikes">DZone: How to Troubleshoot Sudden CPU Spikes</a> Your Java application has been running fine, but all of a sudden CPU consumption starts to go higher and higher... sound familiar?</li>
<li><a href="https://dzone.com/refcardz/java-caching">DZone refcard: Java Caching</a></li>
<li><a href="https://dzone.com/articles/7-jvm-arguments-of-highly-effective-applications-1">Dzone: 7 JVM Arguments of Highly Effective Applications üåüüåüüåü</a> How to use 7 JVM arguments to help increase your application's performance and avoid common memory pitfalls.</li>
</ul>
<h3 id="tuning-jenkins-gc">Tuning Jenkins GC</h3>
<ul>
<li><a href="https://jenkins.io/blog/2016/11/21/gc-tuning/">jenkins.io - Tuning Jenkins GC For Responsiveness and Stability with Large Instances üåü</a></li>
</ul>
<h3 id="tuning-java-containers">Tuning Java Containers</h3>
<ul>
<li><a href="https://blog.openshift.com/scaling-java-containers/">blog.openshift.com: Scaling Java Containers üåü</a></li>
<li><a href="https://blog.openshift.com/performance-metrics-apm-spring-boot-microservices-openshift/">blog.openshift.com: Performance Metrics (APM) for Spring Boot Microservices on OpenShift</a></li>
<li><a href="https://dzone.com/articles/java-ram-usage-in-containers-top-5-tips-not-to-los">dzone.com: Java RAM Usage in Containers: Top 5 Tips for Not Losing Your Memory</a></li>
<li><a href="https://dzone.com/articles/running-a-jvm-in-a-container-without-getting-kille">dzone.com: Running a JVM in a Container Without Getting Killed:</a> Starting in JDK 9, and earlier if you use JDK 8u131, your JVM can detect how much memory is available when running inside a Docker container.</li>
<li><a href="https://dzone.com/articles/java-inside-docker-what-you-must-know-to-not-fail">dzone.com: Java Inside Docker: What You Must Know to Not FAIL</a> If you've tried Java in containers, particularly Docker, you might have encountered some problems with the JVM and heap size. Here's how to fix it.</li>
</ul>
<h3 id="debugging-java-applications-on-openshift-and-kubernetes">Debugging java applications on OpenShift and Kubernetes</h3>
<ul>
<li><a href="https://blog.openshift.com/debugging-java-applications-on-openshift-kubernetes/">blog.openshift.com: Debugging Java Applications On OpenShift and Kubernetes</a></li>
</ul>
<h2 id="list-of-performance-analysis-tools">List of Performance Analysis Tools</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/List_of_performance_analysis_tools">en.wikipedia.org/wiki/List_of_performance_analysis_tools</a></li>
<li><a href="https://en.wikipedia.org/wiki/InspectIT">InspectIT</a></li>
<li><a href="https://en.wikipedia.org/wiki/VisualVM">VisualVM</a></li>
<li><a href="https://en.wikipedia.org/wiki/OverOps">OverOps</a></li>
<li><a href="https://en.wikipedia.org/wiki/FusionReactor">FusionReactor</a></li>
<li>etc</li>
</ul>
<h3 id="threadumps-heapdumps-and-gc-analysis-tools">Threadumps, Heapdumps and GC Analysis Tools</h3>
<ul>
<li><a href="https://tier1app.com/">tier1app.com</a></li>
<li><a href="https://fastthread.io/">fastthread.io</a></li>
<li><a href="https://gceasy.io/">gceasy.io</a></li>
<li><a href="https://heaphero.io/">heaphero.io</a></li>
</ul>
<h4 id="capturing-a-java-thread-dump">Capturing a Java Thread Dump</h4>
<ul>
<li><a href="https://www.baeldung.com/java-thread-dump">baeldung.com: Capturing a Java Thread Dump</a></li>
</ul>
<h2 id="garbage-collection-and-heap-offloading">Garbage Collection and Heap Offloading</h2>
<ul>
<li><a href="http://ehcache.org/">Tecnolog√≠as de Heap-Offloading son EHcache, Memcached, Jillegal library, etc.</a></li>
<li><a href="https://github.com/serkan-ozal/jillegal">Jillegal OffHeap Module</a></li>
<li><a href="http://freepromagazine.blogspot.de/2014/07/free-eguide-jvm-troubleshooting-guide.html">Free eGuide: JVM Troubleshooting Guide</a></li>
<li><a href="http://karunsubramanian.com/websphere/one-important-change-in-memory-management-in-java-8/">Cambios importantes en la gesti√≥n de memoria de Java 8 de Oracle</a></li>
<li><a href="http://www.infoq.com/articles/Java-PERMGEN-Removed">PermGen eliminado</a></li>
<li><a href="http://www.javacodegeeks.com/2014/12/on-heap-vs-off-heap-memory-usage.html">On heap vs off heap memory usage</a></li>
<li><a href="http://apmblog.dynatrace.com/2011/05/11/how-garbage-collection-differs-in-the-three-big-jvms/">How Garbage Collection differs in the three big JVMs</a></li>
<li><a href="http://www.cubrid.org/blog/dev-platform/how-to-tune-java-garbage-collection">cubrid.org: How to Tune Java Garbage Collection</a></li>
<li><a href="https://dzone.com/articles/revisiting-the-advanced-theories-of-java-garbage-c">DZone: Revisiting the Advanced Theories of ‚ÄòJava Garbage Collection‚Äô üåü</a></li>
<li><a href="https://dzone.com/articles/understanding-the-java-memory-model-and-the-garbag">DZone: Understanding the Java Memory Model and Garbage Collection üåü</a> In this article we will try to understand the Java memory model and how garbage collection works. In this article I have used JDK8 Oracle Hot Spot 64 bit JVM. First let me depict the different memory areas available for Java processes.</li>
<li><a href="https://dzone.com/articles/memory-leak-andjava-code">DZone: Memory Leaks and Java Code</a> When you aren't using objects, but they aren't touched by GC, a memory leak happens. Here are six ways memory leaks happen to look for and avoid.</li>
</ul>
<h2 id="cambios-importantes-en-la-gestion-de-memoria-de-java-8-de-oracle-2014">Cambios importantes en la gesti√≥n de memoria de Java 8 de Oracle (2014)</h2>
<p>PermGen no pertenece al heap y los objetos no son promocionados a esta secci√≥n de memoria gestionada durante un GC. Como bien dices es un espacio contiguo al heap, pero tambi√©n se limpia cada vez que la tenured/old generation procede a un GC. No es una generaci√≥n separada del mismo modo que es la young generation, y no hay un mecanismo espec√≠fico para un GC separado de PermGen. La tenured/old generation y la permanent generation proceden a un GC cuando una de las dos se llena.</p>
<p>De todos modos no me queda claro si incorporaron PermGen dentro del heap en Java 7, aunque poco importa ya con los cambios en Java 8.</p>
<p>Mejor empiezo por introducir qu√© implementaci√≥n de JVM es Java 8 de Oracle. Existen numerosas implementaciones de JVM y cada una utiliza diferentes soluciones para la gesti√≥n de memoria.</p>
<p>Dos de las soluciones m√°s conocidas y populares de JVM han sido HotSpot de Sun (habitual en Tomcat) y JRockit de BEA (Weblogic). Ambas compa√±ias fueron compradas por Oracle y Java 8 viene a ser la integraci√≥n definitiva de ambas soluciones.</p>
<p>Hist√≥ricamente se consideraba que HotSpot es el JVM con mejor rendimiento de las dos, si bien JRockit es valorada como la m√°s escalable.</p>
<p>Originalmente en HotSpot no hab√≠a generaci√≥n permanente. Objetos y clases de JVM se almacenaban juntas. Las clases de √©sta JVM eran est√°ticas y pr√°cticamente no se utilizaban 'Class Loaders' (Load y Unload/Collection de Clases). PermGen surgi√≥ como una mejora de rendimiento. Por defecto los datos en la generaci√≥n permanente no se eliminan nunca (son datos de JVM y no de aplicaci√≥n, pudiendo variar seg√∫n la p√≥l√≠tica de garbage collection). Esto pod√≠a llenar la generaci√≥n permanente generando un OutOfMemoryErrors si se produc√≠a un elevado n√∫mero de classloading. En muchos casos un problema con una generaci√≥n permanente implica reiniciar regularmente la JVM y la aplicaci√≥n Java.</p>
<p>Actualmente las clases de JVM son din√°micas y el espacio requerido para metadatos puede cambiar f√°cilmente.</p>
<p>A diferencia de HotSpot VM, JRockit carece de generaci√≥n permanente y en cambio almacena los metadatos 'off the heap' en memoria nativa. Estos buffers de c√≥digo son liberados constantemente cuando sus ClassLoaders no se utilizan. El problema de OutOfMemory en JRockit no es diferente a HotSpot, excepto por el hecho de ser memoria nativa en lugar de memoria heap. Hay dos diferencias significativas. Primero, en JRockit la limpieza de metadatos est√° habilitada siempre por defecto y segundo, no hay tama√±o l√≠mite fijo para el espacio de metadatos. Uno de los principales problemas con HotSpot es su dificultad para seleccionar un tama√±o adecuado para la generaci√≥n permanente. ¬ø128MB, 256MB? Es muy dif√≠cil acertar para cada aplicaci√≥n. JRockit es din√°mico en la gesti√≥n de memoria reservada para metadatos y sin l√≠mites de tama√±o (a excepci√≥n de la memoria del sistema). JRockit es tambi√©n el √∫nico JVM con soporte de heaps no contiguos (uso de memoria por encima y por debajo del alojamiento del kernel y otras librer√≠as), importante en el caso de Windows donde su kernel a menudo se ubica en mitad del espacio de direcciones.</p>
<p>Java 8 (HotRockit?) incorpora todas las herramientas de monitorizaci√≥n de HotSpot (Java VisualVM, jstat, jmap) y JRockit (Java Mission Control, Java Flight Recorder). Muy interesante.</p>
<p>Un inconveniente de Java 8 es la fragmentaci√≥n de la memoria nativa para metadatos, pero probablemente incluya compactaci√≥n en un futuro pr√≥ximo.</p>
<p>En el 2016 saldr√° Java 9 con la funcionalidad de auto-tuning y soporte de tama√±os Heap multi-gigas.</p>
<p>En cualquier caso hay una tendencia al Heap-Offloading. El consumo de memoria en Java tiene un coste y las pausas/latencias causadas por los Full GC son proporcionales al tama√±o del heap. Estas pausas son notables en tama√±os de heap &gt; 1Gb, con un considerable impacto en aplicaciones de tiempo real donde un proceso que no responde r√°pido puede ser descartado del cluster. A√∫n as√≠, los servidores actuales hacen uso de frameworks muy pesados y f√°cilmente requieren heaps &gt; 4Gb. Una soluci√≥n a este problema es alojar fuera del heap los objetos poco utilizados mediante t√©cnicas de serializaci√≥n/deserializaci√≥n (cach√©). El heap de memoria se mantiene peque√±o y el Full GC se completa en milisegundos. Ejemplos:</p>
<ol>
<li>cach√© de sesi√≥n de usuarios, donde un fichero mapeado en memoria almacena gigabytes de sesiones de usuarios inactivos. Una vez que el usuario hace log-in, la aplicaci√≥n dispone de todos sus datos sin ser necesaria una consulta a la BBDD. </li>
<li>cach√© de resultados computacionales como queries, p√°ginas html, etc (donde el coste computacional es mayor a la deserializaci√≥n)</li>
</ol>
<div class="container">
<iframe src="//www.slideshare.net/slideshow/embed_code/key/NpUYrnBQ59fyV6" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen class="video"> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/feuteston/jvm-internals-2015corkdevio" title="JVM Internals (2015)" target="_blank">JVM Internals (2015)</a> </strong> from <strong><a href="//www.slideshare.net/feuteston" target="_blank">Luiz Fernando Teston</a></strong> </div>
</div>
<p><br/></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../jvm-parameters-matrix-table/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../jvm-parameters-matrix-table/" class="btn btn-xs btn-link">
        Java Parameters Matrix Table
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../xamarin/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../xamarin/" class="btn btn-xs btn-link">
        Xamarin
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/melvinpetix/library/edit/master/docs/java-and-java-performance-optimization.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p><p>2020 melvinpetix‚Ñ¢</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/melvinpetix/library/">Windmill Dark</a> theme by melvinpetix (noraj).</p>
</footer>

</body>
</html>